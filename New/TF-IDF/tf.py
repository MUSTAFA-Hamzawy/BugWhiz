import pandas as pd
import os
from sklearn.model_selection import train_test_split
from sklearn.feature_extraction.text import TfidfVectorizer
from sklearn.metrics.pairwise import cosine_similarity

# Define the directory paths
directories = [
    ("..\\new_dataset\\eclipse", "..\\new_dataset\\eclipse"),
    #("..\\new_dataset\\eclipse_test", "..\\new_dataset\\eclipse_test"),
    #("..\\new_dataset\\firefox", "..\\new_dataset\\firefox"),
    #("..\\new_dataset\\netbeans", "..\\new_dataset\\netbeans"),
    #("..\\new_dataset\\openoffice", "..\\new_dataset\\openoffice")
]

# Initialize TF-IDF vectorizer
tfidf_vectorizer = TfidfVectorizer()

# Concatenate preprocessed descriptions from all files in all directories
all_preprocessed_desc = []

# Iterate over each directory
for source_dir, target_dir in directories:
    # Iterate over each file in the directory
    for file_name in os.listdir(source_dir):
        print(file_name)

        # Check if the file is a CSV file        
        if file_name.endswith(".csv"):
            # Load the CSV file
            df = pd.read_csv(os.path.join(source_dir, file_name))
            
            # Check if the DataFrame is empty (end of file reached)
            if df.empty:
                print("End of file reached for:", file_name)
                continue

            # Get the data from the preprocessed_description column
            short_desc = df['preprocessed_description'].astype(str)

            # Concatenate the preprocessed descriptions
            all_preprocessed_desc.extend(short_desc)

    print("Preprocessing done for all files in:", source_dir)

# Fit TF-IDF vectorizer on combined data to build the vocabulary
tfidf_vectorizer.fit(all_preprocessed_desc)


# Choose two preprocessed descriptions for similarity comparison
description1 = """
error log date fri jan cet message could not load tasklist hyperlink detector extension severity info plugin id org eclipse mylyn stack trace org eclipse core runtime coreexception plug in org eclipse mylyn java ui wa unable to load class org eclipse mylyn internal java ui javastacktracehyperlinkdetector at org eclipse core internal registry osgi registrystrategyosgi throwexception registrystrategyosgi java at org eclipse core internal registry osgi registrystrategyosgi createexecutableextension registrystrategyosgi java at org eclipse core internal registry extensionregistry createexecutableextension extensionregistry java at org eclipse core internal registry configurationelement createexecutableextension configurationelement java at org eclipse core internal registry configurationelementhandle createexecutableextension configurationelementhandle java at org eclipse mylyn internal task ui util tasksuiextensionreader readhyperlinkdetector tasksuiextensionreader java at org eclipse mylyn internal task ui util tasksuiextensionreader initstartupextensions tasksuiextensionreader java at org eclipse mylyn task ui tasksuiplugin start tasksuiplugin java at org eclipse osgi framework internal core bundlecontextimpl run bundlecontextimpl java at java security accesscontroller doprivileged native method at org eclipse osgi framework internal core bundlecontextimpl startactivator bundlecontextimpl java at org eclipse osgi framework internal core bundlecontextimpl start bundlecontextimpl java at org eclipse osgi framework internal core bundlehost startworker bundlehost java at org eclipse osgi framework internal core abstractbundle start abstractbundle java at org eclipse osgi framework util secureaction run secureaction java at java security accesscontroller doprivileged native method at org eclipse osgi framework util secureaction start secureaction java at org eclipse core runtime internal adaptor eclipselazystarter postfindlocalclass eclipselazystarter java at org eclipse osgi baseadaptor loader classpathmanager findlocalclass classpathmanager java at org eclipse osgi internal baseadaptor defaultclassloader findlocalclass defaultclassloader java at org eclipse osgi framework internal core bundleloader findlocalclass bundleloader java at org eclipse osgi framework internal core singlesourcepackage loadclass singlesourcepackage java at org eclipse osgi framework internal core bundleloader findclassinternal bundleloader java at org eclipse osgi framework internal core bundleloader findclass bundleloader java at org eclipse osgi framework internal core bundleloader findclass bundleloader java at org eclipse osgi internal baseadaptor defaultclassloader loadclass defaultclassloader java at java lang classloader loadclass classloader java at java lang classloader loadclassinternal classloader java at java lang class getdeclaredconstructors native method at java lang class privategetdeclaredconstructors class java at java lang class getconstructor class java at java lang class newinstance class java at java lang class newinstance class java at org eclipse osgi framework internal core abstractbundle loadbundleactivator abstractbundle java at org eclipse osgi framework internal core bundlecontextimpl start bundlecontextimpl java at org eclipse osgi framework internal core bundlehost startworker bundlehost java at org eclipse osgi framework internal core abstractbundle start abstractbundle java at org eclipse osgi framework util secureaction run secureaction java at java security accesscontroller doprivileged native method at org eclipse osgi framework util secureaction start secureaction java at org eclipse core runtime internal adaptor eclipselazystarter postfindlocalclass eclipselazystarter java at org eclipse osgi baseadaptor loader classpathmanager findlocalclass classpathmanager java at org eclipse osgi internal baseadaptor defaultclassloader findlocalclass defaultclassloader java at org eclipse osgi framework internal core bundleloader findlocalclass bundleloader java at org eclipse osgi framework internal core bundleloader findclassinternal bundleloader java at org eclipse osgi framework internal core bundleloader findclass bundleloader java at org eclipse osgi framework internal core bundleloader findclass bundleloader java at org eclipse osgi internal baseadaptor defaultclassloader loadclass defaultclassloader java at java lang classloader loadclass classloader java at org eclipse osgi framework internal core bundleloader loadclass bundleloader java at org eclipse osgi framework internal core bundlehost loadclass bundlehost java at org eclipse osgi framework internal core abstractbundle loadclass abstractbundle java at org eclipse core internal registry osgi registrystrategyosgi createexecutableextension registrystrategyosgi java at org eclipse core internal registry extensionregistry createexecutableextension extensionregistry java at org eclipse core internal registry configurationelement createexecutableextension configurationelement java at org eclipse core internal registry configurationelementhandle createexecutableextension configurationelementhandle java at org eclipse ui internal workbenchplugin run workbenchplugin java at org eclipse swt custom busyindicator showwhile busyindicator java at org eclipse ui internal workbenchplugin createextension workbenchplugin java at org eclipse ui internal decorator lightweightdecoratordefinition run lightweightdecoratordefinition java at org eclipse core runtime saferunner run saferunner java at org eclipse core runtime platform run platform java at org eclipse ui internal decorator lightweightdecoratordefinition internalgetdecorator lightweightdecoratordefinition java at org eclipse ui internal decorator lightweightdecoratordefinition decorate lightweightdecoratordefinition java at org eclipse ui internal decorator lightweightdecoratormanager lightweightrunnable run lightweightdecoratormanager java at org eclipse core runtime saferunner run saferunner java at org eclipse core runtime platform run platform java at org eclipse ui internal decorator lightweightdecoratormanager decorate lightweightdecoratormanager java at org eclipse ui internal decorator lightweightdecoratormanager getdecorations lightweightdecoratormanager java at org eclipse ui internal decorator decorationscheduler ensureresultcached decorationscheduler java at org eclipse ui internal decorator decorationscheduler run decorationscheduler java at org eclipse core internal job worker run worker java org eclipse core runtime coreexception org eclipse core runtime internal adaptor eclipselazystarter terminatingclassnotfoundexception an error occurred while automatically activating bundle org eclipse mylyn java ui at org eclipse core runtime internal adaptor eclipselazystarter postfindlocalclass eclipselazystarter java at org eclipse osgi baseadaptor loader classpathmanager findlocalclass classpathmanager java at org eclipse osgi internal baseadaptor defaultclassloader findlocalclass defaultclassloader java at org eclipse osgi framework internal core bundleloader findlocalclass bundleloader java at org eclipse osgi framework internal core bundleloader findclassinternal bundleloader java at org eclipse osgi framework internal core bundleloader findclass bundleloader java at org eclipse osgi framework internal core bundleloader findclass bundleloader java at org eclipse osgi internal baseadaptor defaultclassloader loadclass defaultclassloader java at java lang classloader loadclass classloader java at org eclipse osgi framework internal core bundleloader loadclass bundleloader java at org eclipse osgi framework internal core bundlehost loadclass bundlehost java at org eclipse osgi framework internal core abstractbundle loadclass abstractbundle java at org eclipse core internal registry osgi registrystrategyosgi createexecutableextension registrystrategyosgi java at org eclipse core internal registry extensionregistry createexecutableextension extensionregistry java at org eclipse core internal registry configurationelement createexecutableextension configurationelement java at org eclipse core internal registry configurationelementhandle createexecutableextension configurationelementhandle java at org eclipse mylyn internal task ui util tasksuiextensionreader readhyperlinkdetector tasksuiextensionreader java at org eclipse mylyn internal task ui util tasksuiextensionreader initstartupextensions tasksuiextensionreader java at org eclipse mylyn task ui tasksuiplugin start tasksuiplugin java at org eclipse osgi framework internal core bundlecontextimpl run bundlecontextimpl java at java security accesscontroller doprivileged native method at org eclipse osgi framework internal core bundlecontextimpl startactivator bundlecontextimpl java at org eclipse osgi framework internal core bundlecontextimpl start bundlecontextimpl java at org eclipse osgi framework internal core bundlehost startworker bundlehost java at org eclipse osgi framework internal core abstractbundle start abstractbundle java at org eclipse osgi framework util secureaction run secureaction java at java security accesscontroller doprivileged native method at org eclipse osgi framework util secureaction start secureaction java at org eclipse core runtime internal adaptor eclipselazystarter postfindlocalclass eclipselazystarter java at org eclipse osgi baseadaptor loader classpathmanager findlocalclass classpathmanager java at org eclipse osgi internal baseadaptor defaultclassloader findlocalclass defaultclassloader java at org eclipse osgi framework internal core bundleloader findlocalclass bundleloader java at org eclipse osgi framework internal core singlesourcepackage loadclass singlesourcepackage java at org eclipse osgi framework internal core bundleloader findclassinternal bundleloader java at org eclipse osgi framework internal core bundleloader findclass bundleloader java at org eclipse osgi framework internal core bundleloader findclass bundleloader java at org eclipse osgi internal baseadaptor defaultclassloader loadclass defaultclassloader java at java lang classloader loadclass classloader java at java lang classloader loadclassinternal classloader java at java lang class getdeclaredconstructors native method at java lang class privategetdeclaredconstructors class java at java lang class getconstructor class java at java lang class newinstance class java at java lang class newinstance class java at org eclipse osgi framework internal core abstractbundle loadbundleactivator abstractbundle java at org eclipse osgi framework internal core bundlecontextimpl start bundlecontextimpl java at org eclipse osgi framework internal core bundlehost startworker bundlehost java at org eclipse osgi framework internal core abstractbundle start abstractbundle java at org eclipse osgi framework util secureaction run secureaction java at java security accesscontroller doprivileged native method at org eclipse osgi framework util secureaction start secureaction java at org eclipse core runtime internal adaptor eclipselazystarter postfindlocalclass eclipselazystarter java at org eclipse osgi baseadaptor loader classpathmanager findlocalclass classpathmanager java at org eclipse osgi internal baseadaptor defaultclassloader findlocalclass defaultclassloader java at org eclipse osgi framework internal core bundleloader findlocalclass bundleloader java at org eclipse osgi framework internal core bundleloader findclassinternal bundleloader java at org eclipse osgi framework internal core bundleloader findclass bundleloader java at org eclipse osgi framework internal core bundleloader findclass bundleloader java at org eclipse osgi internal baseadaptor defaultclassloader loadclass defaultclassloader java at java lang classloader loadclass classloader java at org eclipse osgi framework internal core bundleloader loadclass bundleloader java at org eclipse osgi framework internal core bundlehost loadclass bundlehost java at org eclipse osgi framework internal core abstractbundle loadclass abstractbundle java at org eclipse core internal registry osgi registrystrategyosgi createexecutableextension registrystrategyosgi java at org eclipse core internal registry extensionregistry createexecutableextension extensionregistry java at org eclipse core internal registry configurationelement createexecutableextension configurationelement java at org eclipse core internal registry configurationelementhandle createexecutableextension configurationelementhandle java at org eclipse ui internal workbenchplugin run workbenchplugin java at org eclipse swt custom busyindicator showwhile busyindicator java at org eclipse ui internal workbenchplugin createextension workbenchplugin java at org eclipse ui internal decorator lightweightdecoratordefinition run lightweightdecoratordefinition java at org eclipse core runtime saferunner run saferunner java at org eclipse core runtime platform run platform java at org eclipse ui internal decorator lightweightdecoratordefinition internalgetdecorator lightweightdecoratordefinition java at org eclipse ui internal decorator lightweightdecoratordefinition decorate lightweightdecoratordefinition java at org eclipse ui internal decorator lightweightdecoratormanager lightweightrunnable run lightweightdecoratormanager java at org eclipse core runtime saferunner run saferunner java at org eclipse core runtime platform run platform java at org eclipse ui internal decorator lightweightdecoratormanager decorate lightweightdecoratormanager java at org eclipse ui internal decorator lightweightdecoratormanager getdecorations lightweightdecoratormanager java at org eclipse ui internal decorator decorationscheduler ensureresultcached decorationscheduler java at org eclipse ui internal decorator decorationscheduler run decorationscheduler java at org eclipse core internal job worker run worker java caused by org osgi framework bundleexception the activator org eclipse mylyn internal java ui javauibridgeplugin for bundle org eclipse mylyn java ui is invalid at org eclipse osgi framework internal core abstractbundle loadbundleactivator abstractbundle java at org eclipse osgi framework internal core bundlecontextimpl start bundlecontextimpl java at org eclipse osgi framework internal core bundlehost startworker bundlehost java at org eclipse osgi framework internal core abstractbundle start abstractbundle java at org eclipse osgi framework util secureaction run secureaction java at java security accesscontroller doprivileged native method at org eclipse osgi framework util secureaction start secureaction java at org eclipse core runtime internal adaptor eclipselazystarter postfindlocalclass eclipselazystarter java more caused by java lang noclassdeffounderror org eclipse mylyn internal context ui abstractcontextuiplugin at java lang classloader defineclass native method at java lang classloader defineclass classloader java at org eclipse osgi internal baseadaptor defaultclassloader defineclass defaultclassloader java at org eclipse osgi baseadaptor loader classpathmanager defineclass classpathmanager java at org eclipse osgi baseadaptor loader classpathmanager findclassimpl classpathmanager java at org eclipse osgi baseadaptor loader classpathmanager findlocalclassimpl classpathmanager java at org eclipse osgi baseadaptor loader classpathmanager findlocalclass classpathmanager java at org eclipse osgi internal baseadaptor defaultclassloader findlocalclass defaultclassloader java at org eclipse osgi framework internal core bundleloader findlocalclass bundleloader java at org eclipse osgi framework internal core bundleloader findclassinternal bundleloader java at org eclipse osgi framework internal core bundleloader findclass bundleloader java at org eclipse osgi framework internal core bundleloader findclass bundleloader java at org eclipse osgi internal baseadaptor defaultclassloader loadclass defaultclassloader java at java lang classloader loadclass classloader java at org eclipse osgi framework internal core bundleloader loadclass bundleloader java at org eclipse osgi framework internal core bundlehost loadclass bundlehost java at org eclipse osgi framework internal core abstractbundle loadbundleactivator abstractbundle java more
"""
description2 = """
build id build id m step to reproduce navigating between eclipse view i dontt know which action exactly brings up this error more information entry org eclipse ui workbench message problem occurred when invoking code from plug in org eclipse ui workbench stack java lang nosuchmethoderror org eclipse mylyn internal context core interactioncontextmanager getscalingfactors lorg eclipse mylyn internal context core scalingfactors at org eclipse mylyn internal team ui contextactivechangesetmanager shouldremove contextactivechangesetmanager java at org eclipse mylyn internal team ui contextactivechangesetmanager interestchanged contextactivechangesetmanager java at org eclipse mylyn internal context core interactioncontextmanager notifyinterestdelta interactioncontextmanager java at org eclipse mylyn internal context core interactioncontextmanager processinteractionevent interactioncontextmanager java at org eclipse mylyn internal context core interactioncontextmanager processinteractionevent interactioncontextmanager java at org eclipse mylyn internal context core interactioncontextmanager processinteractionevent interactioncontextmanager java at org eclipse mylyn internal resource ui editorinteractionmonitor editorbroughttotop editorinteractionmonitor java at org eclipse mylyn monitor ui abstracteditortracker partbroughttotop abstracteditortracker java at org eclipse ui internal partlistenerlist run partlistenerlist java at org eclipse core runtime saferunner run saferunner java at org eclipse core runtime platform run platform java at org eclipse ui internal partlistenerlist fireevent partlistenerlist java at org eclipse ui internal partlistenerlist firepartbroughttotop partlistenerlist java at org eclipse ui internal partservice firepartbroughttotop partservice java at org eclipse ui internal wwinpartservice partbroughttotop wwinpartservice java at org eclipse ui internal partlistenerlist run partlistenerlist java at org eclipse core runtime saferunner run saferunner java at org eclipse core runtime platform run platform java at org eclipse ui internal partlistenerlist fireevent partlistenerlist java at org eclipse ui internal partlistenerlist firepartbroughttotop partlistenerlist java at org eclipse ui internal partservice firepartbroughttotop partservice java at org eclipse ui internal workbenchpagepartlist firepartbroughttotop workbenchpagepartlist java at org eclipse ui internal workbenchpagepartlist fireactiveeditorchanged workbenchpagepartlist java at org eclipse ui internal partlist setactiveeditor partlist java at org eclipse ui internal workbenchpage makeactiveeditor workbenchpage java at org eclipse ui internal workbenchpage setactivepart workbenchpage java at org eclipse ui internal workbenchpage requestactivation workbenchpage java at org eclipse ui internal partpane requestactivation partpane java at org eclipse ui internal editorpane requestactivation editorpane java at org eclipse ui internal partpane setfocus partpane java at org eclipse ui internal editorpane setfocus editorpane java at org eclipse ui internal partstack presentationselectionchanged partstack java at org eclipse ui internal partstack access partstack java at org eclipse ui internal partstack selectpart partstack java at org eclipse ui internal presentation util tabbedstackpresentation handleevent tabbedstackpresentation java at org eclipse ui internal presentation util abstracttabfolder fireevent abstracttabfolder java at org eclipse ui internal presentation util abstracttabfolder fireevent abstracttabfolder java at org eclipse ui internal presentation defaultpresentation defaulttabfolder access defaulttabfolder java at org eclipse ui internal presentation defaultpresentation defaulttabfolder handleevent defaulttabfolder java at org eclipse swt widget eventtable sendevent eventtable java at org eclipse swt widget widget sendevent widget java at org eclipse swt widget widget sendevent widget java at org eclipse swt widget widget sendevent widget java at org eclipse swt widget widget notifylisteners widget java at org eclipse swt custom ctabfolder setselection ctabfolder java at org eclipse swt custom ctabfolder onmouse ctabfolder java at org eclipse swt custom ctabfolder handleevent ctabfolder java at org eclipse swt widget eventtable sendevent eventtable java at org eclipse swt widget widget sendevent widget java at org eclipse swt widget display rundeferredevents display java at org eclipse swt widget display readanddispatch display java at org eclipse ui internal workbench runeventloop workbench java at org eclipse ui internal workbench runui workbench java at org eclipse ui internal workbench access workbench java at org eclipse ui internal workbench run workbench java at org eclipse core databinding observable realm runwithdefault realm java at org eclipse ui internal workbench createandrunworkbench workbench java at org eclipse ui platformui createandrunworkbench platformui java at org eclipse ui internal ide application ideapplication start ideapplication java at org eclipse equinox internal app eclipseapphandle run eclipseapphandle java at org eclipse core runtime internal adaptor eclipseapplauncher runapplication eclipseapplauncher java at org eclipse core runtime internal adaptor eclipseapplauncher start eclipseapplauncher java at org eclipse core runtime adaptor eclipsestarter run eclipsestarter java at org eclipse core runtime adaptor eclipsestarter run eclipsestarter java at sun reflect nativemethodaccessorimpl invoke native method at sun reflect nativemethodaccessorimpl invoke unknown source at sun reflect delegatingmethodaccessorimpl invoke unknown source at java lang reflect method invoke unknown source at org eclipse equinox launcher main invokeframework main java at org eclipse equinox launcher main basicrun main java at org eclipse equinox launcher main run main java
"""

# Transform the two descriptions into TF-IDF vectors
desc1_tfidf = tfidf_vectorizer.transform([description1])
desc2_tfidf = tfidf_vectorizer.transform([description2])

# Compute cosine similarity between the two descriptions
similarity_score = cosine_similarity(desc1_tfidf, desc2_tfidf)

print("Cosine Similarity between the two descriptions:", similarity_score[0][0])
